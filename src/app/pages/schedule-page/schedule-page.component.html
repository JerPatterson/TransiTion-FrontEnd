<nav class="header">
    <h1 class="page-title">Horaire des passages</h1>
    <hr class="delimitation">
</nav>

<div class="container">
    <div class="row">
        <h3 class="column-title route">&nbsp;</h3>
        <h3 class="column-title schedule">Planifiés</h3>
        <h3 class="column-title prediction">Temps réel</h3>
        <h3 class="column-title state">État du service</h3>
    </div>
    <hr class="delimitation">

    <ul class="container-content">
        <li *ngFor="let time of times" 
            class="row row-element" 
            (click)="onClick(time)"
            [ngClass]="time.tripId === this.time.tripId ? 'selected' : ''" 
        >
            <p class="route route-icon">
                <span>{{ time.routeId }}</span>
            </p>

            <p class="schedule">
                {{ this.formatTimeToWait(time.stMinutesAhead, time.stSecondsAhead) }}
            </p>

            <p class="prediction">
                <br *ngIf="!time.rtMinutesAhead || !time.rtSecondsAhead">
                <span *ngIf="time.rtMinutesAhead && time.rtSecondsAhead">
                    {{ this.formatTimeToWait(time.rtMinutesAhead, time.rtSecondsAhead) }}
                </span>
            </p>

            <p class="state">
                <br *ngIf="getTripArrivalState(time) === 4">
                <span *ngIf="time.rtMinutesAhead && time.rtSecondsAhead">
                    <span *ngIf="getTripArrivalState(time) === 0">
                        En avance de {{ this.formatTimeDifference(time) }}
                    </span>
                    <span *ngIf="getTripArrivalState(time) === 1">
                        À l'heure
                    </span>
                    <span *ngIf="getTripArrivalState(time) === 2">
                        En retard de {{ this.formatTimeDifference(time) }}
                    </span>
                </span>
            </p>
        </li>
    </ul>
</div>

<app-map 
    [agencyId]="agencyId ? agencyId : ''" 
    [routeId]="routeId ? routeId : ''"
    [shapeId]="time ? time.shapeId : ''">
</app-map>
